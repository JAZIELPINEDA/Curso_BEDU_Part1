/*Usando la base de datos tienda, define las siguientes vistas que permitan obtener la siguiente información.*/
USE tienda;
/*AÑADE A TODOS LOS NOMBRES DE TUS VISTAS EL SUFIJO _<tu identificador>. Por ejemplo mi_vista_hermosa_123.*/

/*Obtener el puesto de un empleado.*/
CREATE VIEW Puesto_9315 AS
(SELECT concat(e.nombre, ' ', e.apellido_paterno) Empleado, e.id_empleado, p.nombre AS Puesto
FROM puesto p
JOIN empleado e
  ON p.id_puesto = e.id_puesto);

SELECT *
FROM Puesto_9315;

/*Saber qué artículos ha vendido cada empleado.*/
CREATE VIEW Articulos_9315 AS
(SELECT concat(e.nombre, ' ', e.apellido_paterno) Empleado, a.nombre AS Articulo
FROM venta v
JOIN empleado e
  ON v.id_empleado = e.id_empleado
JOIN articulo a
  ON v.id_articulo = a.id_articulo);

SELECT *
FROM Articulos_9315
ORDER BY Empleado;

/*Saber qué puesto ha tenido más ventas.*/
CREATE VIEW Ventas_9315 AS
(SELECT v.clave, v.fecha, a.nombre producto, a.precio, concat(e.nombre, ' ', e.apellido_paterno) empleado 
FROM venta v
JOIN empleado e
  ON v.id_empleado = e.id_empleado
JOIN articulo a
  ON v.id_articulo = a.id_articulo);

SELECT *
FROM Ventas_9315
ORDER BY a.precio DESC;
